<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>CodePen - Hacker Login Form</title>
  <link rel="stylesheet" href="./style.css">
  <!-- 1. 引入Vue.js框架 -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <!-- 引入axios套件，用來串接API -->
  <script src="https://cdn.jsdelivr.net/npm/axios@1.1.2/dist/axios.min.js"></script>
</head>
<body>
<!-- partial:index.partial.html -->
<!doctype html>

<html lang="en"> 
  
 <head> 

  <meta charset="UTF-8"> 

  <title>CodePen - Animated Login Form using Html &amp; CSS Only</title> 

  <link rel="stylesheet" href="./style.css"> 

 </head> 

 <body id="app"> 

  <section> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> <span></span> 

   <div class="signin"> 

    <div class="content"> 

     <h2 @click="testClick()">{{message}} Sign In</h2> 

      <div class="form"> 

        <div class="inputBox"> 
          <!-- 綁定username變數給input -->
          <input v-model="username" type="text" name="username" required> <i>帳號 {{ message }}</i>
        </div> 

        <div class="inputBox"> 
          <!-- 將password變數榜定給input -->
          <input v-model="password" type="password" required> <i>密碼</i> 
        </div> 
        <div v-if="isUsernameNotFound" class="login-failed1">帳號不存在</div>
        <div v-if="isPasswordError" class="login-failed2">密碼錯誤</div>

        <div class="links"> 
          <a href="#">Forgot Password</a> <a href="#">Signup</a> 
        </div> 

        <div class="inputBox"> 
          <input type="submit" value="登入" @click="login()"> 
        </div> 

      </div> 

    </div> 

   </div> 

  </section>
 </body>

</html>
  
</body>
<!-- 3. 建立Vue物件並初始化 -->
<script>
  const { createApp } = Vue

  createApp(
    {
      data() {
        return {
          count: 0,
          message: "",
          username: '', //存放使用者輸入的帳號用
          password: '',  //存放使用者輸入的密碼用
          isUsernameNotFound:false,
          isPasswordError:false
        }
      },
      // Vue要使用的方法
      methods:{
        //測試click
        testClick(){
          this.message="Andy"
        },
        //登入用的方法
        login() {
          console.log('login');
          console.log('username=' + this.username);
          console.log('password=' + this.password);

          //串接登入API
          axios.get('/login?username=' + this.username + '&password=' + this.password)
          .then((response) => { 
            console.log(response); 

            this.isUsernameNotFound = false;
            this.isPasswordError = false;
            //處理API的回應
            if(response.status == 200){
              // console.log('呼叫API成功');
              if(response.data.code == 0){ //登入失敗
                this.isUsernameNotFound = true;
                console.log('帳號不存在');
              }else if(response.data.code == 1){
                this.isPasswordError = true;
                console.log('密碼錯誤');
              }else{
                console.log("登入成功");
                location.href="product.html?username=" + this.username;
              }
            }
          })
        }
      }

    }
  ).mount('#app')
</script>
</html>
<!-- 
  想一想 
  1. 有v-model就不用form處理表單?
  2. 一個div包一個欄位
  3. v-model的變數代表
-->